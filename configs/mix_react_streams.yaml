metadata:
  title: Mixing two streams
  description: |-
    A Cantera example showcasing mixing of air and methane streams in stoichiometric
    proportions. Since reactors can have multiple inlets and outlets, they can be used to
    implement mixers, splitters, etc. Due to the low temperature, no reactions occur.

    Note that the air stream and the methane stream use different reaction mechanisms,
    with different numbers of species and reactions. When gas flows from one reactor
    or reservoir to another one with a different reaction mechanism, species are matched
    by name. If the upstream reactor contains a species that is not present in the
    downstream reaction mechanism, it will be ignored. In general, reaction mechanisms
    for downstream reactors should contain all species that might be present in any
    upstream reactor.
  source_file: mix1.py

phases:
  gas:
    mechanism: gri30.yaml
    description: |-
      GRI-Mech 3.0 mechanism used for stream b (methane) and for the mixer.
      If a pure mixer with no chemistry is desired, use a reaction mechanism
      with no reactions instead.
  air:
    mechanism: air.yaml
    description: |-
      Air mechanism used for stream a (air inlet) and outlet reservoir.
      Contains ideal gas properties for air components.
settings: {}

nodes:
- id: Air Reservoir
  Reservoir:
    temperature: 300.0
    pressure: 101325.00000000003
    composition: N2:0.78,O2:0.21,AR:0.01
  mechanism: air.yaml
  description: |-
    Upstream reservoir for air stream (stream a). Uses air.yaml mechanism.
    Could be replaced by reactors which might themselves be connected to
    reactors further upstream.
- id: Fuel Reservoir
  Reservoir:
    temperature: 300.0
    pressure: 101325.00000000001
    composition: CH4:1
  description: |-
    Upstream reservoir for methane stream (stream b). Uses GRI-Mech 3.0.
    Could be replaced by reactors which might themselves be connected to
    reactors further upstream.
- id: Mixer
  IdealGasReactor:
    temperature: 299.9999999999867
    pressure: 101326.46614484335
    composition: N2:0.719557,O2:0.193727,CH4:0.0774908,AR:0.00922509
    volume: 1.0
  description: |-
    Reactor for mixing air and methane streams. A reactor is required instead
    of a reservoir, since the state will change with time if the inlet mass
    flow rates change or if there is chemistry occurring.
- id: Outlet Reservoir
  Reservoir:
    temperature: 300.0
    pressure: 101325.00000000003
    composition: N2:0.78,O2:0.21,AR:0.01
    mass_flow_rate: 0.6516985521312658
  mechanism: air.yaml
  description: |-
    Downstream reservoir for the mixed outlet stream. Could be replaced with
    a reactor with no outlet, if it is desired to integrate the composition
    leaving the mixer in time, or by an arbitrary network of downstream reactors.

connections:
- id: Air Inlet
  MassFlowController:
    mass_flow_rate: 14.01  # kg/s - stoichiometric air flow (rho_air * 2.5 / 0.21)
  source: Air Reservoir
  target: Mixer
  description: |-
    Mass flow controller connecting the air reservoir to the mixer.
    Mass flow rate set to values corresponding to stoichiometric combustion.
- id: Fuel Inlet
  MassFlowController:
    mass_flow_rate: 0.657  # kg/s - methane flow (rho_methane * 1.0)
  source: Fuel Reservoir
  target: Mixer
  description: |-
    Mass flow controller connecting the fuel reservoir to the mixer.
    Mass flow rate set to values corresponding to stoichiometric combustion.
- id: Valve
  Valve:
    valve_coeff: 10.0
  source: Mixer
  target: Outlet Reservoir
  description: |-
    Valve connecting the mixer to the downstream reservoir.
    Controls flow based on pressure difference.
